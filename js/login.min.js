"use strict";(()=>{async function s(){try{let t=await fetch("/config.json",{cache:"no-store"});if(!t.ok)throw new Error(`Network response was not ok, status: ${t.status}`);let o=await t.json();if(!o.adminPasswordHash)throw new Error("Password hash not found in config file.");return o.adminPasswordHash}catch(t){return console.error("Failed to load admin configuration:",t),alert("Erreur critique: Impossible de charger la configuration de s\xE9curit\xE9. Veuillez contacter le support."),null}}async function i(t){let o=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(t));return Array.from(new Uint8Array(o)).map(e=>e.toString(16).padStart(2,"0")).join("")}async function d(){let t=document.getElementById("loginBtn"),o=document.getElementById("adminPwd");if(!t||!o){console.error("Login form elements not found.");return}let e=await s();if(!e){t.disabled=!0,o.disabled=!0,o.placeholder="Configuration error";return}if(localStorage.getItem("adminPasswordHash")===e){window.location.href="admin.html";return}let r=async()=>{let n=o.value.trim();if(!n){alert("Veuillez entrer un mot de passe.");return}let a=await i(n);a===e?(localStorage.setItem("adminPasswordHash",a),window.location.href="admin.html"):(alert("Mot de passe incorrect."),o.value="")};t.addEventListener("click",r),o.addEventListener("keypress",n=>{n.key==="Enter"&&r()})}document.addEventListener("DOMContentLoaded",d);})();
