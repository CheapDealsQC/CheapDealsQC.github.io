<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>SpotiDeals – Admin</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body{font-family:system-ui,sans-serif;margin:0;background:#f3f3f3}
  main{max-width:820px;margin:2rem auto;padding:1.5rem;background:#fff;border-radius:12px}
  h1{margin-top:0}
  table{width:100%;border-collapse:collapse;margin-top:1rem}
  th,td{padding:.6rem;border-bottom:1px solid #ddd;text-align:left;font-size:.95rem}
  select{padding:.3rem}
</style>
</head>
<body>
<main id="app" hidden>
  <h1>Suivi des commandes</h1>
  <table>
    <thead><tr><th>ID</th><th>Date</th><th>Statut</th></tr></thead>
    <tbody id="tbody"></tbody>
  </table>
</main>

<script>
  const PASSWORD = "1C1GCEA_enCA1146CA1146&oq=&gs_lcrp=EgZjaHJvbWUqEQgDEAAYAxhCGI8BGLQCGOoCMgkIABAjGCcY6gIyCQgBECMYJxjqAjIJCAIQIxgnGOoCMhEIAxAAGAMYQhiPARi0AhjqAjIRCAQQABgDGEIYjwEYtAIY6gIyEQg";
  if (prompt("Mot de passe admin ?") === PASSWORD) {
    document.getElementById('app').hidden = false;
    const tbody = document.getElementById('tbody');
    Object.keys(localStorage).sort().forEach(id=>{
      if(!id.startsWith('SD-')) return;
      const {date,status} = JSON.parse(localStorage.getItem(id));
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${id}</td><td>${new Date(date).toLocaleString()}</td>
        <td>
          <select>
            <option ${status==='En cours'?'selected':''}>En cours</option>
            <option ${status==='Livré'?'selected':''}>Livré</option>
            <option ${status==='Remboursé'?'selected':''}>Remboursé</option>
          </select>
        </td>`;
      tr.querySelector('select').onchange = e=>{
        localStorage.setItem(id, JSON.stringify({date,status:e.target.value}));
      };
      tbody.appendChild(tr);
    });
  } else {
    alert("Accès refusé.");
    location.href="/";
  }
</script>
</body>
</html>
